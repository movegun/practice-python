#x축 날짜 y축 평균거래가격
str = '540954	538876	536079	532409	529733	525131	521123	515846	511823	508217	505494	499900	496180	494168	493675	494492	495511	493908	490682	488116	488428	490519	490840	490524	490995	492451	494338	494478	494042	493673	493652	494256	496425	498452	499009	498927	500454	502150	504979	508683	512004	515481	537536	540479	543833	547153	549204	551299	551346	550462	550313	550936	552227	553603	555720	558017	554800	559311	562096	562278	562025	562529	565946	567740	570287	576774	579325	582818	582609	584459	587516	659905	673522	686220	691838	693673	694435	694739	695931	702383	716453	720347	719724	717749	810129	806027	802157	799211	797617	797214	798302	799721	801480	807121	813573	827228	877128	877185	876857	873791	870742	871897	881834	886216	888511	889368	890267	893100	897254	903824	907112	911604	917127	928126	1109300	1119250	1130427	1140659	1148288	1151469	1151721	1150842	1150146	1150416	1148808	1148214'

prices_box = str.split()
prices = []
for price in prices_box:
    price = int(price)*1000
    prices.append(price)

str = '2012년 01월	2012년 02월	2012년 03월	2012년 04월	2012년 05월	2012년 06월	2012년 07월	2012년 08월	2012년 09월	2012년 10월	2012년 11월	2012년 12월	2013년 01월	2013년 02월	2013년 03월	2013년 04월	2013년 05월	2013년 06월	2013년 07월	2013년 08월	2013년 09월	2013년 10월	2013년 11월	2013년 12월	2014년 01월	2014년 02월	2014년 03월	2014년 04월	2014년 05월	2014년 06월	2014년 07월	2014년 08월	2014년 09월	2014년 10월	2014년 11월	2014년 12월	2015년 01월	2015년 02월	2015년 03월	2015년 04월	2015년 05월	2015년 06월	2015년 07월	2015년 08월	2015년 09월	2015년 10월	2015년 11월	2015년 12월	2016년 01월	2016년 02월	2016년 03월	2016년 04월	2016년 05월	2016년 06월	2016년 07월	2016년 08월	2016년 09월	2016년 10월	2016년 11월	2016년 12월	2017년 01월	2017년 02월	2017년 03월	2017년 04월	2017년 05월	2017년 06월	2017년 07월	2017년 08월	2017년 09월	2017년 10월	2017년 11월	2017년 12월	2018년 01월	2018년 02월	2018년 03월	2018년 04월	2018년 05월	2018년 06월	2018년 07월	2018년 08월	2018년 09월	2018년 10월	2018년 11월	2018년 12월	2019년 01월	2019년 02월	2019년 03월	2019년 04월	2019년 05월	2019년 06월	2019년 07월	2019년 08월	2019년 09월	2019년 10월	2019년 11월	2019년 12월	2020년 01월	2020년 02월	2020년 03월	2020년 04월	2020년 05월	2020년 06월	2020년 07월	2020년 08월	2020년 09월	2020년 10월	2020년 11월	2020년 12월	2021년 01월	2021년 02월	2021년 03월	2021년 04월	2021년 05월	2021년 06월	2021년 07월	2021년 08월	2021년 09월	2021년 10월	2021년 11월	2021년 12월	2022년 01월	2022년 02월	2022년 03월	2022년 04월	2022년 05월	2022년 06월'
dates_box = str.split()
str=''
for date in dates_box:
    str=str+date

str = str.replace('월','월 ')
dates = str.split()

print("len(prices_box):",len(prices_box))
from itertools import count
from re import X
import matplotlib.pyplot as plt
import numpy as np

x_arr = np.array(dates[0:120])
y_arr = np.array(prices[0:120])
#plt.plot(x_arr,y_arr,'o--')

from scipy import stats as st
from sklearn.metrics import r2_score

xs = []
for i in range(1,len(dates)+1):
    xs.append(i)
    i=i+1
list_Date_to_int = np.array(xs)
list_Date_to_int = list_Date_to_int[0:120]
plt.scatter(list_Date_to_int,y_arr)
#plt.show()
arr1 = np.polyfit(list_Date_to_int,y_arr,3)
mymodel = np.poly1d(arr1)
print("mymodel \n:", mymodel)

myline = np.linspace(1,120,10000)
plt.plot(myline,mymodel(myline))
#plt.ylim(min(y_arr),max(y_arr))
plt.show()

print("x_arr 갯수 :",count(list_Date_to_int))
r = r2_score(y_arr,mymodel(list_Date_to_int))
print("r:",r)

#최종 x값 = 126  >> 다음달의 index 는 127

print("2022년 6월의 매매평균가는 ",mymodel(123))